**软件需求规范文档**
**Software Requirements Specifications Document (SRS)**

> 本文档参照IEEE Guide to Software Requirements Specifications (Std 830-1993). 本文档只用于定义软件的需求分析、功能和接口定义，不涉及软件的具体实现方法。

- 项目名称：**自动咖啡的嵌入式控制软件的开发**

- 开发团队：华中科技大学机械学院RTCSD2017课程第四组

- 版本号：(1.0)	

- 日期： (10/19/2017)


# 1. 引言
本项目是华中科技大学机械学院RTCSD2017课程的课程设计，我们小组会合作完成自动咖啡的嵌入式控制软件的开发项目的设计。我们组成员有：
- 周磊
- 柯金洋
- 田越鑫
- 刘成龙
- 冉亮

## 1.1 编写目的

本文档用于指导自动咖啡的嵌入式控制软件的开发过程，与软件用户定义和明确软件的功能需求。本文档的目标读者为软件用户和软件开发项目组成员。

## 1.2 背景

### 1.2.1 立项目标

本实例来自贝加莱公司文档，需要开发咖啡机的嵌入式控制软件，实现如下功能：

1）用户在咖啡机面板上选择自己想要喝的咖啡（美式、拿铁、卡布奇诺...）并按下开始按钮后，咖啡机开始按照设定的配方制作咖啡。
2）制作流程为：Feeder机构取一空杯放到传送带上，传送带把空杯送到龙头下，牛奶、糖浆、浓缩咖啡液和热水按照配方比例混合后装入空杯，传送带把满杯的咖啡送到用户取杯处，用户取走咖啡后，自动咖啡机可以继续响应面板上的按钮制作下一杯咖啡。

### 1.2.2 类似产品分析
（1） 本校的大型自动咖啡机
在学校的图书馆和大型教学楼里有自动咖啡售卖机。用户选择自己需要的口味，并支付后，机器会自动冲泡，功能比较强大。

（2） 家用自动咖啡机
此类产品在淘宝京东等线上电商平台均有销售，小巧便捷，可实现自动磨制。功能齐全，还有暖杯等各种实用功能。但是容量较小。


## 1.3 定义和缩写
（1）咖啡机
全自动咖啡机（Automatic Coffee Machine）指的是，只需按下按钮便可以制作出一杯咖啡的机器——其实现了从咖啡豆磨粉到热水冲煮出咖啡的全过程自动化。
全自动咖啡机是整个咖啡机行业里发展最快的。从1999年GAGGIA发布了第一台能制作Espresso（意式浓缩咖啡）的全自动咖啡机，各个不同的咖啡机厂商都在致力于研究开发，使得其功能不断的完善，已经有能加热牛奶并把它按比例配在咖啡里的高端机型面市。好的全自动咖啡机制作出来的咖啡完全可以和商用专业机相媲美，而因其能自动磨豆且相对于专业机来说价格又低很多，所以从问世以来便一直受到家庭及办公场所的青睐。随着咖啡文化在国内的深入，全自动咖啡机正掀起一股新的购买热潮。
为满足自动加热、冲咖啡、咖啡机添水、洗咖啡机都能自动完成，咖啡机的设计人员设计出了全自动咖啡机，全自动咖啡机比起普通咖啡机添加了许多功能，一般全自动咖啡机包括如下功能：程序设置、清洁功能，加热系统、数码智能控制等。
（2）咖啡种类


美式咖啡其实就是兑了大半杯白开水的Espresso，一般水与咖啡的比例是2:1。

拿铁是Espresso和牛奶的经典结合，牛奶与咖啡的比例一般控制在1.5:1。在咖啡的顶端还会加上一些奶泡，优秀的咖啡师还能为你呈现出漂亮的拉花。

很容易跟拿铁混在一起，二者的区别是在牛奶和奶泡的比例上，牛奶与咖啡的比例一般控制在1:1，卡布奇诺的奶泡多于牛奶。
	由于原料中只有咖啡、牛奶、糖、和水，没有奶泡，所以在本设计中不考虑奶泡。另外，个人认为糖的多少要看个人喜好，可加可不加，但是为了设计的方便，只有卡布奇诺加糖，其他不加糖。
## 1.4 参考资料

[1]https://baike.baidu.com/item/%E5%85%A8%E8%87%AA%E5%8A%A8%E5%92%96%E5%95%A1%E6%9C%BA/342271?fr=aladdin

[2]https://baike.baidu.com/item/%E8%87%AA%E5%8A%A8%E5%92%96%E5%95%A1%E6%9C%BA/342029?fr=aladdin
[3] http://v.youku.com/v_show/id_XMTY5OTI5OTY1Ng==.html
[4] https://www.zhihu.com/question/28289825

# 2. 任务概述

## 2.1 目标
编写自动咖啡的嵌入式控制软件控制系统完成如下过程：
用户选择需要的咖啡种类，Feeder取杯子送上ConveyorBelt，传送带将杯子准确送到BrewingAssembly下，BrewingAssembly按照用户的选择将各种原料和热水混合搅拌充分，打开龙头，放入杯子中，传送带把满杯的咖啡送到用户取杯处，杯子被取走后，机器可以接受下一个咖啡制作指令。
## 2.2 用户的特点

本系统面向有自主行为能力的普通咖啡消费者。

## 2.3 假定和约束

- 实验条件： 安装有MATLAB/Simulink软件的计算机、GitHub、一块STM32开发板
- 开发期限：2017年10月完成软件开发，2017年11月完成集成调试。
- 开发流程：
 1）第一阶段，软件团队与咖啡机产品经理（老师和助教）沟通软件开发需求，形成软件设计规格书，清晰的定义控制软件的各项功能、硬件输入和输出接口。（本阶段交付件：软件设计规格书）
2）第二阶段，在Matlab/Simulink环境中，实现咖啡机的物理建模，同时完成控制软件的概要设计，划分成若干个软件模块，确保模块覆盖设计规格书的所有功能，清晰定义各个模块的接口。（本阶段交付件：咖啡机物理模型文件和概要设计说明书）
3）第三阶段，基于simulink/stateflow建模方法，设计各个软件模块的控制逻辑和算法，并与咖啡机物理模型进行协同仿真，实现整个咖啡制作流程。（本阶段交付件：控制软件模块stateflow模型文件）
4）第四阶段，基于模块的stateflow模型，手动编写或用自动代码生成工具，完成C代码设计工作。（本阶段交付件：模块C代码及代码自动生成报告）
5）第五阶段，基于MATLAB工具，对模块C代码进行Software in Loop测试或Processor in Loop测试，得到测试报告。（本阶段交付件：SIL/PIL测试报告）
6）第六阶段，提交项目总结和软件说明文档。（本阶段交付件：项目总结和软件说明文档）
# 3. 需求规定

## 3.1 功能需求规定

### 3.1.1 功能1 美式咖啡

#### 功能描述：美式咖啡的原料是沸水和咖啡，配料时只开对应的两个阀门，并完成美式咖啡制作。
#### 输入：用户指令“美式咖啡”
#### 参数：
#### 处理过程：Feeder取杯子送上ConveyorBelt，传送带将杯子准确送到BrewingAssembly下，BrewingAssembly按照用户的选择将各种原料和热水混合搅拌充分，打开龙头，放入杯子中，传送带把满杯的咖啡送到用户取杯处，杯子被取走后，机器可以接受下一个咖啡制作指令。
#### 输出：美式咖啡

### 3.1.2 功能2 卡布奇诺

#### 功能描述：卡布奇诺的原料是沸水、咖啡、牛奶和糖，配料时对应的阀门打开，并完成卡布奇诺制作。
#### 输入：用户指令“美式咖啡”
#### 参数：
#### 处理过程：Feeder取杯子送上ConveyorBelt，传送带将杯子准确送到BrewingAssembly下，BrewingAssembly按照用户的选择将各种原料和热水混合搅拌充分，打开龙头，放入杯子中，传送带把满杯的咖啡送到用户取杯处，杯子被取走后，机器可以接受下一个咖啡制作指令。
#### 输出：卡布奇诺

### 3.1.3 功能3 拿铁

#### 功能描述：拿铁的原料是沸水、咖啡和牛奶，配料时对应的阀门打开，并完成拿铁制作。
#### 输入：用户指令“拿铁”
#### 参数：
#### 处理过程：Feeder取杯子送上ConveyorBelt，传送带将杯子准确送到BrewingAssembly下，BrewingAssembly按照用户的选择将各种原料和热水混合搅拌充分，打开龙头，放入杯子中，传送带把满杯的咖啡送到用户取杯处，杯子被取走后，机器可以接受下一个咖啡制作指令。
#### 输出：拿铁

### 3.1.4 功能4 选择咖啡种类

#### 用户能在面板上选择咖啡的种类。用户的选择作为Brewing Assembly 模块的输入，选择不同的配方泡制搅拌；同时Feeder模块激活，准备取杯子。


### 3.1.5 功能5 Feeder自动取空杯

#### Feeder接收用户的选择指令，完成Grab-->Down-->Rotate 180°-->Up-->Lose一套动作，同时激活Conveyor Belt

### 3.1.6 功能6 传送带送杯子

#### 传送带把杯子送到Brewing Assembly下方，咖啡不会洒落。Feeder动作完成后，控制Conveyor Belt的运动至Brewing Assembly下方，动作结束激活Brewing Assembly

### 3.1.7 功能7 将泡好的咖啡倒入杯子中

#### Brewing Assembly激活后，打开阀门，结束时关闭阀门，然后激活Conveyor Belt

### 3.1.8 功能8 送走咖啡等待指令

#### 送走泡好的咖啡等待下一个咖啡制作指令，在这之前面板不会接收新指令。由传感器发出信号，面板接收指令。

### 3.1.9 功能9 报警

#### 杯子和原料用完时能报警，机器不能产生动作。由传感器发出信号，面板接收信号。


## 3.2 性能需求的规定

### 3.2.1 精度要求
能保证整个的咖啡制作过程顺畅进行，不致产生液体溅出和溢出等现象即可。

### 3.2.2 实时性要求
能保证整个的咖啡制作过程顺畅进行，不致产生液体溅出和溢出等现象即可。

### 3.2.3 开放性和扩展性
后期可扩展支持选择不同浓淡的咖啡，根据个人需求选择加糖的量。

## 3.3 输入输出要求

### 硬件接口：


### 软件接口：


## 3.4 数据存储和管理能力要求

### 数据保存
用户选择自己喜欢的口味后，用户的选择被保存起来，在完成本次制作之前不响应其他的用户输入。

## 3.5 故障和错误处理要求

## 3.6 其他特殊要求

待补充。

# 4. 用例


## 4.1 用例1：***操作过程

## 4.2 用例2：***实时画面

# 5. 运行环境规定
## 5.1 硬件设备及接口
STM32开发板
## 5.2 软件平台及配置

MATLAB/Simulink



## 5.3 通信协议


# 6. 附录

## 6.1 **协议定义
